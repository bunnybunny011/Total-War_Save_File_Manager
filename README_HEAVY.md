# 🎮 Total War Save Manager [HEAVY Version] (v3.4.0)

> **상태**: HEAVY 버전 (개발 중 - Final Isolation)

본 문서는 일반 버전보다 훨씬 강력한 분석 엔진을 탑재한 **HEAVY 버전**의 기술적 로직과 매커니즘을 설명합니다.

## 🧠 핵심 로직: Absolute v5 Strict Context

일반적인 텍스트 검색 방식은 세이브 파일 내의 수많은 AI 군주 데이터와 플레이어 데이터를 구분하지 못해 오인식을 일으키기 쉽습니다. HEAVY 버전은 이를 해결하기 위해 다음의 **Absolute v5** 엔진을 사용합니다.

### 1. 2단계 엄격 검증 (Two-Pass Scanning)
- **1단계 (세력 확정)**: 파일 내의 `local_faction` 마커를 추적하여 플레이어가 현재 플레이 중인 세력(예: 북방 변경주)을 먼저 확정합니다.
- **2단계 (군주 결속)**: 확정된 세력이 '케세이'라면, 검색 후보군에서 '스카브란드', '카타린' 등 **타 종족 군주를 완전히 배제**합니다. 오직 케세이 후보군(묘영, 조명, 원보) 내에서만 최종 매칭을 수행합니다.

### 2. mmap 기반 대용량 스캐닝
- 파일을 메모리에 직접 로드하는 방식이 아닌, OS 레벨의 **Memory Mapping(mmap)** 기술을 사용하여 **10MB 이상의 대용량 영역**을 순식간에 분석합니다.
- 파일의 **헤더(10MB) + 푸터(1MB) + 중간 지점**을 모두 스캔하여 인식 사각지대를 제로화했습니다.

### 3. 유니코드 및 다중 오프셋 디코딩
- 토탈워 세이브 특유의 `UTF-16LE` 인코딩과 데이터 밀림 현상을 해결하기 위해 **0오프셋/1오프셋 가상 디코딩**을 동시에 수행합니다. 깨진 텍스트 속에서도 한글과 영문 키워드를 정확히 포착합니다.

## 🛠 보조 도구: Deep Analyzer
- **`Deep_Analyzer.py`**: 현재 세이브 폴더를 전수 조사하여 게임 내부의 모든 시스템 코드를 인덱싱합니다. 새로운 DLC나 군주가 추가되었을 때 즉시 대응할 수 있는 전문가용 도구입니다.

## ⚠️ 주의사항
- 본 버전은 **실험적(Heavy)** 버전으로, 인식률을 99.9%까지 끌어올리기 위해 더 많은 시스템 자원을 사용합니다.
- 파일 경로 및 계정 정보 보호를 위해 모든 경로는 환경 변수(`%APPDATA%`) 기반으로 동작합니다.

---
**Author**: Antigravity AI (HEAVY Version Development)
**Version**: v3.4.0 "Final Isolation"
